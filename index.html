<html>

    <head>
        <meta charset="UTF-8"> 
        <style>
         .oculto{
             display: none;
         }

        </style>

    </head>



    <body>
        <form id="formulario" autocomplete="off">
            <input autocomplete="false" name="hidden" type="text" class="oculto">
            <input type="text" id="palabra" placeholder="Palabra a leer" autocomplete="off" />
            <input type="submit" id="enviar" value="Enviar"/>
            <input type="button" id="escuchar" value="Escuchar"/>
        </form>
        <iframe class="oculto" id="player"></iframe>
        
        <script>
         function l(msg){ console.log(msg); }
         function e(id){ return document.getElementById(id); }
         function v(id){ return e(id).value; }
         function r(a){return a[Math.floor(Math.random()*a.length)]; }

         function siguiente(){
             e("palabra").value = "";
             secreto = r(secretos);
             e("escuchar").click();
         }         
         
         function play(value,speed){
             l(value);
             if( !speed || !Number.isInteger(speed)){
                 speed = 0;
             }
             value = value.replace("&"," ");
             let link = `http://api.voicerss.org/?key=7ce3372599eb47b18cf59793351ceaa2&hl=es-es&r=${speed}&src=${value}`
             e("player").src = link;
         }

         function palabra(secreto){
             l( typeof secreto )
             if( typeof secreto === "string" )
                 return secreto;
             else
                 return secreto[0];
         }

         function descripcion(secreto){
             if( typeof secreto === "string" )
                 return secreto;
             else
                 return secreto[0] + ", " + secreto[1];
         }

         function later(f,m){
             if( !m ){
                 m = 3000;
             }
             window.setTimeout(f,m);
         }

         function acierto(p){
             e("palabra").value = "";
             play("Correcto, la siguiente palabra es");
         }

         function fallo(secreto,p){
             e("palabra").value="";
             play( `Incorrecto. Intenta otra vez ${descripcion(secreto)}`);
         }
         

         l("Cargando script");

         e("formulario").onsubmit = function(){
             let p = v("palabra");
             if( p.toLowerCase().trim() === palabra(secreto).toLowerCase().trim() ){
                 acierto(secreto);
                 later( siguiente );
             }
             else{
                 fallo(secreto,p);
             }
             return false;
         }

         e("escuchar").onclick = function(){
             play(descripcion(secreto),-5);
         }
         
         var secretos = [
             "proyecto", "proyección", "trabajo", "tubería", "jirafa",
             ["vaca", "el animal"],
             ["baca", "utensilio"],
             ["hay", "el verbo"],
             "desarrollarse",
             "descripción",
             "acabarse",
             "velocidad",
             "atención",
             "exámenes",
             "ovoide",
             "garaje",
             ["haya", "el árbol"],
             ["haya", "del verbo haber"],
             ["halla", "del verbo hallar"],
             "hallar",
             "verbo",
             "advervio",
             "arbol",
             ["está","de verbo estar"],
             "estructura",
             "huyes",
             "trabas",
             "insensibilicemos",
             "atrás",
             "dejándolo",
             "desarrollar",
             
             
         ];

	 function addSecretos(str){
	   str.
	     replace(/\.|;|:|1|2|3|4|5|6|7|8|9|0/g, " ").
             split(" ").
             filter( (el) => el != "" ).
             forEach( (el) => secretos.push(el) );

	 }

	 addSecretos( "había2. hoy3. una vez4. ayer5. hombre6. entonces7. siempre8. después9. iba10. a veces11. barco12. vacaciones13. día. dibujo15. hasta(5)16. hay (6)17. invierno18. verano19. primavera20. otoño21. jefe22. jersey23. canguro4. máquina25. marrón26. verde27. rojo28. árbol29. abeja30. bosque31. cigüeña32. selva33. oveja34. ciervo35. frío36. gitana37. guerra38. rey39. viejo40. guitarra41. mayor42. muy43. quería44. queso45. zanahoria46. huevo47. hueso48. íbamo49. boca50. extranjero51. está. están53. vosotras54. vuestro55. tío56. abuela57. hijo58. vecina59. habitación60. lenguaje61. matemáticas62. historia3. inglés64. yo65. avión66. ambulancia67. bicicleta68. carrera69. fútbol70. balón71. juego72. columpio73. navidad74. agujero75. caja76. feliz77. también78. ahora79. más80. aquí81. mucho82. gobierno83. país84. dijo85. hecho86. tenía87. hacia8. vamos89. según90. allí91. todavía92. número93. a través94. voy95. hora96. cinco97. quiero98. cabeza99. algún100. María");
         
         var secreto = "";
         play( "Escribe la siguiente palabra");
         later( siguiente );

	  l(JSON.stringify(secretos));
        </script>

    </body>


</html>
